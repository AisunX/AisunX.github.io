<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>AisunX ‚Äî Portfolio</title>
  <meta name="description" content="‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÇ‡∏ü‡∏•‡∏¥‡πÇ‡∏≠‡πÅ‡∏ö‡∏ö‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ ‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å GitHub ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏†‡∏≤‡∏û ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ PDF ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£)" />
  <meta property="og:title" content="AisunX ‚Äî Portfolio" />
  <meta property="og:description" content="‡∏û‡∏≠‡∏£‡πå‡∏ï‡πÇ‡∏ü‡∏•‡∏¥‡πÇ‡∏≠‡πÅ‡∏ö‡∏ö‡∏ó‡∏±‡∏ô‡∏™‡∏°‡∏±‡∏¢ ‡∏î‡∏∂‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏à‡∏≤‡∏Å GitHub ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏†‡∏≤‡∏û ‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ PDF ‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£)" />
  <meta property="og:type" content="website" />
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 256 256'%3E%3Crect width='256' height='256' rx='56' fill='%23000'/%3E%3Ctext x='50%25' y='58%25' text-anchor='middle' font-size='140' font-family='Segoe UI, Inter, system-ui' fill='%23fff'%3EA%3C/text%3E%3C/svg%3E" />
  <style>
    :root{
      --bg: #0b0b10;
      --card: #12121a;
      --text: #e7e7ee;
      --muted: #9aa0aa;
      --brand: #58C5FF;
      --ring: #2b90d9;
      --shadow: 0 10px 30px rgba(0,0,0,.25);
      --radius: 18px;
    }
    @media (prefers-color-scheme: light){
      :root{
        --bg: #f6f7fb;
        --card: #ffffff;
        --text: #0d0f14;
        --muted: #495266;
        --brand: #0077ff;
        --ring: #2b90d9;
        --shadow: 0 10px 25px rgba(0,0,0,.08);
      }
    }
    *{ box-sizing: border-box }
    html,body{ height:100% }
    body{
      margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Inter, Roboto, "Noto Sans Thai", Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 80% -10%, rgba(88,197,255,.15), transparent 55%),
                  radial-gradient(900px 500px at -10% 10%, rgba(0,119,255,.12), transparent 50%), var(--bg);
      color: var(--text);
    }
    a{ color: inherit }
    .wrap{ max-width:1200px; margin:0 auto; padding:28px }

    header{
      position: sticky; top:0; z-index:50; backdrop-filter: saturate(1.3) blur(8px);
      background: color-mix(in oklab, var(--bg) 85%, transparent);
      border-bottom: 1px solid color-mix(in oklab, var(--text) 7%, transparent);
    }
    .nav{
      display:flex; align-items:center; gap:14px; justify-content:space-between; padding:10px 0;
    }
    .brand{ display:flex; align-items:center; gap:10px; text-decoration:none }
    .brand .logo{ width:36px; height:36px; border-radius:10px; display:grid; place-items:center; background:var(--card); box-shadow:var(--shadow); border:1px solid color-mix(in oklab, var(--brand) 60%, transparent)}
    .brand strong{ font-size:18px; letter-spacing:.4px }

    .controls{ display:flex; flex-wrap:wrap; gap:10px; }
    .chip, .btn{
      display:inline-flex; align-items:center; gap:8px; border:1px solid color-mix(in oklab, var(--text) 8%, transparent);
      background: var(--card); color: var(--text); padding:9px 12px; border-radius: 12px; cursor:pointer;
      transition: transform .05s ease, border-color .2s ease; font-size:14px;
    }
    .chip:hover, .btn:hover{ transform: translateY(-1px) }
    .btn.primary{ border-color: color-mix(in oklab, var(--brand) 60%, transparent) }

    .hero{
      display:grid; grid-template-columns:1.2fr .8fr; gap:24px; align-items:center; padding:28px 0 12px;
    }
    @media (max-width: 900px){ .hero{ grid-template-columns:1fr } }
    .heroCard{
      background: linear-gradient(180deg, color-mix(in oklab, var(--brand) 8%, var(--card)), var(--card));
      border: 1px solid color-mix(in oklab, var(--text) 7%, transparent);
      box-shadow: var(--shadow); padding:22px; border-radius: var(--radius);
    }
    .title{ font-size:34px; line-height:1.15; margin:0 0 8px }
    .subtitle{ color: var(--muted); margin:0 0 12px; font-size:16px }

    .quickMeta{ display:flex; flex-wrap:wrap; gap:8px; margin-top:10px }
    .quickMeta .chip{ background: color-mix(in oklab, var(--brand) 10%, var(--card)); border-color: color-mix(in oklab, var(--brand) 20%, transparent) }

    .searchBar{ display:flex; gap:10px; align-items:center; margin-top:14px }
    .searchBar input, .searchBar select{
      background: var(--card); color:var(--text); border-radius:12px; border:1px solid color-mix(in oklab, var(--text) 8%, transparent); padding:10px 12px; outline:none; width:100%;
    }

    .grid{ display:grid; grid-template-columns: repeat(12, 1fr); gap:16px; margin:20px 0 40px }
    .col-3{ grid-column: span 3 }
    .col-4{ grid-column: span 4 }
    .col-6{ grid-column: span 6 }
    .col-12{ grid-column: span 12 }
    @media (max-width: 1200px){ .col-3{ grid-column: span 4 } }
    @media (max-width: 900px){ .col-3, .col-4{ grid-column: span 6 } }
    @media (max-width: 640px){ .col-3, .col-4, .col-6{ grid-column: span 12 } }

    .card{
      background: var(--card); border-radius: var(--radius); overflow:hidden; border:1px solid color-mix(in oklab, var(--text) 7%, transparent); box-shadow: var(--shadow);
      display:flex; flex-direction:column; min-height:220px; position:relative;
    }
    .thumb{ aspect-ratio: 16/9; width:100%; display:block; object-fit:cover; background: #0f1117; border-bottom:1px solid color-mix(in oklab, var(--text) 6%, transparent) }
    .pad{ padding:14px }
    .card h3{ margin:0 0 6px; font-size:16px }
    .muted{ color: var(--muted); font-size:13px }
    .tags{ display:flex; flex-wrap:wrap; gap:6px; margin-top:10px }
    .tag{ font-size:12px; padding:6px 8px; border-radius:999px; border:1px solid color-mix(in oklab, var(--text) 10%, transparent); background: color-mix(in oklab, var(--brand) 6%, var(--card)) }

    .empty{
      text-align:center; padding:40px; border:1px dashed color-mix(in oklab, var(--text) 12%, transparent); border-radius:var(--radius); color:var(--muted)
    }

    footer{ opacity:.85; margin:24px 0 10px; font-size:13px; color:var(--muted) }
    .sr-only{ position:absolute; width:1px; height:1px; margin:-1px; padding:0; overflow:hidden; clip:rect(0,0,0,0); border:0 }
  </style>
</head>
<body>
  <header>
    <div class="wrap nav">
      <a class="brand" href="#">
        <span class="logo" aria-hidden="true">üß©</span>
        <strong>AisunX ¬∑ Portfolio</strong>
      </a>
      <div class="controls">
        <button class="chip" id="themeBtn" title="Toggle theme">üåó ‡∏™‡∏•‡∏±‡∏ö‡∏ò‡∏µ‡∏°</button>
        <a class="btn primary" href="https://github.com/" target="_blank" rel="noreferrer">‚≠ê Follow on GitHub</a>
      </div>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="heroCard">
        <h1 class="title">‡∏£‡∏ß‡∏°‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î ‚Äî ‡∏î‡∏∂‡∏á‡∏ï‡∏£‡∏á‡∏à‡∏≤‡∏Å GitHub</h1>
        <p class="subtitle">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå <code>/content</code> ‡πÉ‡∏ô‡∏£‡∏µ‡πÇ‡∏õ‡∏Ç‡∏≠‡∏á GitHub ‡πÅ‡∏•‡πâ‡∏ß‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡∏î‡∏∂‡∏á‡∏°‡∏≤‡πÇ‡∏ä‡∏ß‡πå‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö‡∏£‡∏π‡∏õ/‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠/PDF/‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£)</p>
        <div class="quickMeta">
          <span class="chip">‚ö° No build tools</span>
          <span class="chip">üìÅ Reads /content</span>
          <span class="chip">üåì Dark/Light</span>
          <span class="chip">üîé ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤ + ‡∏ü‡∏¥‡∏•‡πÄ‡∏ï‡∏≠‡∏£‡πå</span>
        </div>
        <div class="searchBar">
          <input id="search" placeholder="‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡∏á‡∏≤‡∏ô ‡πÄ‡∏ä‡πà‡∏ô binary, ui, poster, report‚Ä¶" />
          <select id="typeFilter" title="‡∏Å‡∏£‡∏≠‡∏á‡∏ï‡∏≤‡∏°‡∏ä‡∏ô‡∏¥‡∏î‡πÑ‡∏ü‡∏•‡πå">
            <option value="all">‡∏ó‡∏∏‡∏Å‡∏ä‡∏ô‡∏¥‡∏î</option>
            <option value="image">‡∏†‡∏≤‡∏û</option>
            <option value="video">‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</option>
            <option value="pdf">PDF</option>
            <option value="doc">‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ (docx/xlsx/pts)</option>
            <option value="other">‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</option>
          </select>
          <select id="repoSelect" title="‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏à‡∏≤‡∏Å‡∏£‡∏µ‡πÇ‡∏õ">
            <option value="">‡∏£‡∏µ‡πÇ‡∏õ‡∏´‡∏•‡∏±‡∏Å (username.github.io)</option>
          </select>
        </div>
      </div>
      <div class="heroCard">
        <h2 style="margin:0 0 8px">‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô (‡πÇ‡∏Ñ‡∏ï‡∏£‡∏á‡πà‡∏≤‡∏¢)</h2>
        <ol style="margin:8px 0 0; padding-left:18px; line-height:1.6; color:var(--muted)">
          <li>‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏£‡∏µ‡πÇ‡∏õ <strong>username.github.io</strong> (‡πÄ‡∏ä‡πà‡∏ô <strong>AisunX.github.io</strong>)</li>
          <li>‡∏ß‡∏≤‡∏á‡πÑ‡∏ü‡∏•‡πå‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô <code>index.html</code> ‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏Å‡∏£‡∏µ‡πÇ‡∏õ</li>
          <li>‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå <code>/content</code> ‡πÅ‡∏•‡πâ‡∏ß‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏ú‡∏•‡∏á‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</li>
          <li>‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö: <code>.png .jpg .webp .gif .mp4 .webm .pdf .docx .pptx .xlsx</code></li>
        </ol>
        <p class="muted" style="margin-top:10px">Tip: ‡∏ñ‡πâ‡∏≤‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏µ‡πÇ‡∏õ ‡πÉ‡∏´‡πâ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÉ‡∏ô‡πÄ‡∏°‡∏ô‡∏π‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô (config ‡πÉ‡∏ô‡∏™‡∏Ñ‡∏£‡∏¥‡∏õ‡∏ï‡πå)</p>
      </div>
    </section>

    <section>
      <h2 class="sr-only">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡∏•‡∏á‡∏≤‡∏ô</h2>
      <div id="items" class="grid"></div>
      <div id="empty" class="empty" style="display:none">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÉ‡∏ô <code>/content</code>. ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏Ç‡∏∂‡πâ‡∏ô GitHub ‡πÅ‡∏•‡πâ‡∏ß‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏´‡∏ô‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢ ‚ú®</div>
    </section>

    <footer>
      ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ ‚ù§ ‡πÇ‡∏î‡∏¢‡∏Ñ‡∏∏‡∏ì ‡πÅ‡∏•‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏ï‡πà‡∏á‡πÇ‡∏î‡∏¢ Cornner ‚Äî ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö GitHub API, ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ö‡∏ô GitHub Pages ‡πÑ‡∏î‡πâ‡∏ó‡∏±‡∏ô‡∏ó‡∏µ
    </footer>
  </main>

  <template id="cardTpl">
    <article class="card col-3">
      <a class="previewLink" target="_blank" rel="noreferrer">
        <img class="thumb" alt="preview" loading="lazy" />
      </a>
      <div class="pad">
        <h3 class="titleSmall"></h3>
        <div class="muted fileMeta"></div>
        <div class="tags"></div>
        <div class="pad" style="display:none"></div>
      </div>
    </article>
  </template>

  <script>
  // ====== BASIC CONFIG ======
  const USERNAME = (location.hostname.split('.')[0] || 'AisunX').toLowerCase();
  const DEFAULT_REPO = `${USERNAME}.github.io`;
  const REPOS = [DEFAULT_REPO]; // üëâ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ä‡∏∑‡πà‡∏≠‡∏£‡∏µ‡πÇ‡∏õ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ ‡πÑ‡∏î‡πâ ‡πÄ‡∏ä‡πà‡∏ô 'portfolio', 'design-assets'
  const CONTENT_PATHS = ['content', 'assets', 'projects']; // ‡∏à‡∏∞‡∏•‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡∏•‡∏≥‡∏î‡∏±‡∏ö

  // ====== HELPERS ======
  const EXTS = {
    image: ['png','jpg','jpeg','webp','gif','svg'],
    video: ['mp4','webm','mov'],
    pdf:   ['pdf'],
    doc:   ['docx','pptx','xlsx','csv','tsv'],
  };
  const ICON = {
    image: 'üñºÔ∏è', video: 'üé¨', pdf: 'üìÑ', doc: 'üìë', other: 'üì¶'
  };
  const byExt = (name) => {
    const ext = name.split('.').pop().toLowerCase();
    for (const [k, arr] of Object.entries(EXTS)) if (arr.includes(ext)) return k; 
    return 'other';
  };
  const toRaw = (apiObj) => apiObj.download_url || apiObj.html_url; // API ‡∏Ñ‡∏∑‡∏ô download_url ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö raw
  const fmtSize = (s) => !s ? '' : (s > 1e6 ? (s/1e6).toFixed(1)+' MB' : s > 1e3 ? (s/1e3).toFixed(1)+' KB' : s+' B');

  // Office viewer ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö docx/xlsx/pptx
  const officeViewer = (rawUrl) => `https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(rawUrl)}`;

  const el = (sel, root=document) => root.querySelector(sel);
  const els = (sel, root=document) => Array.from(root.querySelectorAll(sel));

  // ====== THEME TOGGLE ======
  const themeBtn = el('#themeBtn');
  themeBtn?.addEventListener('click', () => {
    const key = 'theme-preference';
    const cur = localStorage.getItem(key) || 'auto';
    const next = cur === 'dark' ? 'light' : cur === 'light' ? 'auto' : 'dark';
    localStorage.setItem(key, next);
    applyTheme();
  });
  function applyTheme(){
    const pref = localStorage.getItem('theme-preference') || 'auto';
    document.documentElement.dataset.theme = pref;
    themeBtn.textContent = `üåó ‡∏ò‡∏µ‡∏°: ${pref}`;
    if (pref === 'dark') document.documentElement.style.colorScheme = 'dark';
    else if (pref === 'light') document.documentElement.style.colorScheme = 'light';
    else document.documentElement.style.colorScheme = 'light dark';
  }
  applyTheme();

  // ====== FETCH FROM GITHUB ======
  const repoSelect = el('#repoSelect');
  REPOS.forEach(r => {
    const opt = document.createElement('option');
    opt.value = r; opt.textContent = r; repoSelect.appendChild(opt);
  });
  repoSelect.value = DEFAULT_REPO;

  const search = el('#search');
  const typeFilter = el('#typeFilter');
  const itemsWrap = el('#items');
  const empty = el('#empty');

  let ALL_ITEMS = [];

  async function fetchPath(owner, repo, path){
    const url = `https://api.github.com/repos/${owner}/${repo}/contents/${path}`;
    const res = await fetch(url, { headers: { 'Accept': 'application/vnd.github+json' }});
    if (!res.ok) return [];
    const data = await res.json();
    return Array.isArray(data) ? data.filter(x => x.type === 'file') : [];
  }

  async function loadRepo(owner, repo){
    ALL_ITEMS = [];
    itemsWrap.innerHTML = '';
    empty.style.display = 'none';

    for (const p of CONTENT_PATHS){
      try{
        const arr = await fetchPath(owner, repo, p);
        ALL_ITEMS.push(...arr.map(x => ({...x, _repo: repo, _path: p})));
      }catch(_){ /* noop */ }
    }
    // ‡∏ñ‡πâ‡∏≤‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÑ‡∏ü‡∏•‡πå ‡∏•‡∏≠‡∏á‡∏≠‡πà‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏≤‡∏Å‡∏£‡∏µ‡πÇ‡∏õ‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡∏£‡∏≠‡∏á
    if (ALL_ITEMS.length === 0){
      try{ ALL_ITEMS = await fetchPath(owner, repo, ''); }catch(_){ ALL_ITEMS = []; }
      ALL_ITEMS = ALL_ITEMS.filter(x => !['index.html','README.md'].includes(x.name));
    }

    render();
  }

  function render(){
    itemsWrap.innerHTML = '';
    const q = (search.value || '').toLowerCase();
    const t = typeFilter.value;
    const list = ALL_ITEMS.filter(it => {
      const type = byExt(it.name);
      const okType = (t === 'all') || (type === t) || (t==='doc' && type==='doc');
      const okText = !q || it.name.toLowerCase().includes(q);
      return okType && okText;
    });

    if (list.length === 0){ empty.style.display = 'block'; return; } else empty.style.display = 'none';

    for (const it of list){
      const type = byExt(it.name);
      const card = el('#cardTpl').content.firstElementChild.cloneNode(true);
      card.classList.add('col-3');

      const previewLink = el('.previewLink', card);
      const img = el('.thumb', card);
      const title = el('h3', card);
      const meta = el('.fileMeta', card);
      const tags = el('.tags', card);

      const raw = toRaw(it);
      title.textContent = it.name;
      meta.textContent = `${ICON[type]} ${type.toUpperCase()} ¬∑ ${fmtSize(it.size)} ¬∑ ${it._repo}/${it._path}`;

      // Preview strategy by type
      if (type === 'image'){
        img.src = raw; img.alt = it.name; previewLink.href = raw;
      } else if (type === 'video'){
        img.remove();
        const v = document.createElement('video'); v.className = 'thumb'; v.controls = true; v.src = raw; v.playsInline = true; v.preload = 'metadata';
        previewLink.appendChild(v); previewLink.href = raw;
      } else if (type === 'pdf'){
        img.src = 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 56%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%2312111a%22/><text x=%2250%25%22 y=%2252%25%22 fill=%22%23fff%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Segoe UI%22 font-size=%2220%22>PDF Preview</text></svg>';
        previewLink.href = raw; previewLink.target = '_blank';
      } else if (type === 'doc'){
        img.src = 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 56%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%2312111a%22/><text x=%2250%25%22 y=%2252%25%22 fill=%22%23fff%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Segoe UI%22 font-size=%2218%22>Office Doc</text></svg>';
        previewLink.href = officeViewer(raw);
      } else {
        img.src = 'data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 56%22><rect width=%22100%25%22 height=%22100%25%22 fill=%22%2312111a%22/><text x=%2250%25%22 y=%2252%25%22 fill=%22%23fff%22 dominant-baseline=%22middle%22 text-anchor=%22middle%22 font-family=%22Segoe UI%22 font-size=%2220%22>File</text></svg>';
        previewLink.href = raw;
      }

      // tags
      const tg1 = document.createElement('span'); tg1.className = 'tag'; tg1.textContent = type;
      const tg2 = document.createElement('span'); tg2.className = 'tag'; tg2.textContent = it._repo;
      tags.append(tg1, tg2);

      itemsWrap.appendChild(card);
    }
  }

  // Event bindings
  search.addEventListener('input', render);
  typeFilter.addEventListener('change', render);
  repoSelect.addEventListener('change', () => loadRepo(USERNAME, repoSelect.value || DEFAULT_REPO));

  // Start
  loadRepo(USERNAME, DEFAULT_REPO);
  </script>
</body>
</html>
